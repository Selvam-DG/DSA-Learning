# Optimal Merge Pattern – Greedy Method


##  Problem Statement

You are given `n` sorted files with different sizes (number of records).  
You want to **merge all files into a single file** with the **minimum total cost**.

### Cost Rule:
- Merging two files of sizes `x` and `y` costs `x + y`.
- After merging, the resulting file can be merged again with other files.
- The goal is to **minimize the sum of all merge costs**.

---

## Greedy Approach

**Idea**:
- Always merge the **two smallest files** first.
- Repeat until only one file remains.

**Reason**:
- Merging smaller files earlier prevents large file sizes from contributing repeatedly to later merge costs.

---

## Algorithm Steps

1. Insert all file sizes into a **min-heap** (priority queue).
2. While more than one file remains:
   - Extract two smallest sizes.
   - Merge them and calculate the cost.
   - Insert the merged size back into the heap.
   - Add the merge cost to total cost.
3. Output the total cost.

---

## Python Implementation

```python
import heapq

def optimal_merge_pattern(files):
    heapq.heapify(files)  # Min-heap
    total_cost = 0

    while len(files) > 1:
        # Pick two smallest
        first = heapq.heappop(files)
        second = heapq.heappop(files)

        # Merge them
        cost = first + second
        total_cost += cost

        # Push merged file size back
        heapq.heappush(files, cost)

    return total_cost

# Example usage
file_sizes = [20, 30, 10, 5, 30]
print("Minimum total cost:", optimal_merge_pattern(file_sizes))
```
---

### Example
```makefile
Files: [20, 30, 10, 5, 30]
```
**Steps:**
1. Merge 5 & 10 → cost = 15, files = [15, 20, 30, 30]
2. Merge 15 & 20 → cost = 35, files = [30, 30, 35]
3. Merge 30 & 30 → cost = 60, files = [35, 60]
4. Merge 35 & 60 → cost = 95, files = [95]

Total cost = 15 + 35 + 60 + 95 = 205

---

## Time Complexity
- Building heap: `O(n)`
- Each merge: `O(log n)`
- Total merges: `n - 1`
- Overall: `O(n log n)`

---
## Applications
- File merging in external sorting
- Data compression algorithms (e.g., Huffman coding)
- Optimal merge scheduling in databases

## References
Abdul Bari – [Optimal Merge Pattern](https://www.youtube.com/watch?v=HHIc5JZyenI&list=PLDN4rrl48XKpZkf03iYFl-O29szjTrs_O&index=42&ab_channel=AbdulBari)









